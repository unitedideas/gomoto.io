{% load static %}


<!DOCTYPE html>
<html lang="en">
<head>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>
    <title>GoMoto.io</title>

    <!-- Materialize CSS  -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/css/materialize.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/js/materialize.min.js"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">


    <!-- CDNJS :: Vue (https://cdnjs.com/) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/2.5.2/vue.min.js"></script>
    <!-- CDNJS :: Sortable (https://cdnjs.com/) -->
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.7.0/Sortable.min.js"></script>
    <!-- CDNJS :: Vue.Draggable (https://cdnjs.com/) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Vue.Draggable/2.16.0/vuedraggable.min.js"></script>

    <!-- Axios -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <!--Fonts-->
    <link href="https://fonts.googleapis.com/css?family=Libre+Baskerville" rel="stylesheet">


</head>

<style>
    .font_Baskerville {
        font-family: 'Libre Baskerville', serif;
        font-size: 30px;
    }

    .faded_bg {

        background-image: url("{% static 'gomoto/images/title_whip.png' %}");
        background-repeat: no-repeat;
        background-position: center;
        background-size: contain;
        box-shadow: inset 0 0 0 500px rgba(218, 218, 218, .965);

    }

    #nav_bar {
        text-align: center;
        padding-top: 1%;
        margin: 0;
    }

    .background_color {
        background-color: grey;
        z-index: -1;
    }

    #m_buttons {
        margin: 5px;
        text-align: left;
    }

    .btn-large {
        width: 100%;
        color: black;
        background-color: #ff9900;
        font-size: 12px;
        padding: 5px;
    }

    #main_content {
        padding: 0;
        margin: 0;
        min-width: 820px;
    }

    #bike_box {
        padding: 10px;
        padding-right: 0;
        margin-bottom: 20px;
    }

    h5 {
        font-family: "American Typewriter";
    }

</style>

<body class="background_color">
<div style="" id="app">

    <!--Start Navbar-->
    <div id="nav_bar" style="padding-top: 20px; margin: 0px; background-color: black">
        <img style="width: 30%; height: 20%;" src="{% static 'gomoto/images/GoMoto_Logo.png' %}"/>
    </div>

    <!--Start of the bike body (9/12 boxes)-->
    <div id="main_content" class="background_color" style="padding: 0px; margin: 0px">
        <div id="body_container" class="row">

            <div id="bike_container" class="col s9" style="padding-right: 0px; padding-top: 10px">
                <div v-for="(bike, index) in bikes">
                    <div id="bike_box" class="faded_bg z-depth-2"
                         style="padding: 5px; margin-bottom: 20px; background-color: lightgray ">
                        <div class="icon-block row" style="padding: 15px; ">
                            <img class=" light-blue-text left z-depth-2 col s5 m5 l5" style="width:35%; margin: .75rem
                            ;border-style: solid; border-color: black;border-width: 10px;padding: 0; "
                                 v-bind:src="bike.img_src">
                            <h4 class="center" style="padding-top: 5%; padding-bottom: 2%">[[bike.year]] [[bike.make]]
                                [[bike.model]]</h4>
                            <table align="center" class="centered highlight col s10 l6 left" style="margin-left: 6.5%;">
                                <thead>
                                <tr>
                                    <th>Price</th>
                                    <th>Weight</th>
                                    <th>Starter</th>
                                    <th>Displacement</th>
                                    <th>Seat Height</th>
                                    <th>Category</th>
                                    <th>Engine Type</th>
                                </tr>
                                </thead>

                                <tbody>
                                <tr>
                                    <td>[[bike.price]]</td>
                                    <td>[[bike.weight]]</td>
                                    <td>[[bike.starter]]</td>
                                    <td>[[bike.displacement]]</td>
                                    <td>[[bike.seatheight]]</td>
                                    <td>[[bike.category]]</td>
                                    <td>[[bike.engine_type]]</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <!--End of the bike body (9/12 boxes)-->


            <!--Start Welcome-->
            <div id="welcome" class="font_Baskerville faded_bg z-depth-2 col s7 m7 m7 left"
                 style="display:'' ;margin: 100px 0px 0px 100px; margin-right: 0;" v-html='welcome'>
                <div style=" position: absolute;top: 0;left: 0;height: inherit; background-color: rgba(255,254,223,0.8)">
                </div>
            </div>
            <!--End Welcome-->


            <div id="logo">
                <img style=" display: block; width: 25%;margin: auto;"
                     src="{% static 'gomoto/images/GoMoto_mt_bg.png' %}"/>

            </div>
            <!--Start of the Sidebar (3/12 boxes)-->
            <draggable style="padding-left: 3px" class="dragArea col s3 m3 l3 right" v-model="options"
                       @change="get_bikes">
                <div v-for="(element, index) in options">
                    <div class="center">
                        <div id="m_buttons" class="btn-large"><i style=" font-size: 30px;" class="material-icons left">arrow_drop_down_circle</i>[[element.name]]
                        </div>
                    </div>
                </div>
            </draggable>
        </div>
    </div>

    <!--
    arrow_back
    arrow_downward
    arrow_drop_down
    arrow_drop_down_circle
    arrow_drop_up
    arrow_forward
    arrow_upward
    keyboard_arrow_down
    keyboard_arrow_up
    -->

    <script>
        let app = new Vue({
            el: '#app',
            delimiters: ['[[', ']]'],
            data: {
                bikes: [],

                welcome: 'Welcome to Moto.io. <br> Here you can this simple app was created to save you time trying to pick through all the stats of dirt bikes. Look to the right side of the page and drag your top priorities in order starting with the most important at the top. As you do the top three motorcycles that fit your priorities will adjust on the screen. That\'s it!!!. Have fun. <br> -Shane',

                options: [{
                    id: 'price',
                    name: 'Low Price'
                }, {
                    id: 'seatheight',
                    name: 'Low Seat Height'
                }, {
                    id: 'dry_weight',
                    name: 'Light Weight'
                }, {
                    id: 'year',
                    name: 'Newer Year'
                }, {
                    id: 'displacement',
                    name: 'More CC'
                }
                //     {
                //     id: 'starter',
                //     name: 'Electric Start'
                // }
                ],
            },
            methods: {

                get_bikes: function () {
                    let app = this
                    priorities_list = []
                    document.getElementById('welcome').style.display = "none";


                    for (i = 0; i < app.options.length; i++) {
                        priorities_list.push(app.options[i].id)
                    }
                    console.log(priorities_list)
                    axios.post("{% url 'gomoto:get_bikes' %}",
                        {
                            priorities_list
                        }, {
                            headers: {
                                'X-CSRFToken': '{{ csrf_token }}',
                            }
                        })
                        .then(function (response) {
                            console.log(response)
                            app.bikes = response.data.bikes
                            console.log(bikes)
                        })
                },

            },

            // created: function () {
            //     this.get_bikes()
            // },


            // Getting error when trying to run this on created (TypeError, this.welcom is not a function)

            // created: function () {
            //     this.welcome()
            // },


        })
    </script>
</div>
</body>
</html>


